# Курс "Разработка интернет-приложений"

## Полезные команды

- Создание миграции
```
.\venv\Scripts\python.exe -m alembic revision --autogenerate -m "Поменяли password на hashed_password"
```

- Заполнение миграций
```
.\venv\Scripts\python.exe -m alembic upgrade head
```

- Запуск докер-контейнеров
```
docker-compose up -d
```

- Запуск воркера celery
```
python -m celery -A worker worker -l info -Q queue -P solo
```

## 1 задание

1. По аналогии с пользователями, реализовать crud методы для чатов. Все входные и выходные данные должны быть явно прописаны через Pydantic-схемы. При этом get запрос должен возвращать не только информацию о чате, но и список участников-пользователей
2. Продумать сущность "Сообщение", реализовать методы:
   - Отправка сообщения в чат
   - Редактирование сообщения
   - Удаление сообщения
   - Список из N последних сообщений в чате
   - Список из N чатов, в которых была последня активность

## 2 задание

- Работу с чатами аналогично перевести на работу с БД - добавить sqlalchemy-модели, миграции, переписать crud-методы

## 3 задание

- Добавить аутентификацию и работу с текущим пользователем в методы чатов и сообщений
- Реализовать пометку о прочтении сообщения, об изменении сообщения
- (*) Реализовать механизм refresh-token'a

## 4 задание

- Доделать отправку отложенных сообщений (чтобы непосредственно создавались сообщения в БД)
- Доделать работу с вебсокетом, чтобы приходили сообщения о новых сообщениях
- (*) Реализовать аутентификацию для вебсокета
- Добавить обработку хэштегов в сервисе postprocessor